<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Hextra â€“ Lock</title>
    <link>https://mobilephone724.github.io/tags/lock/</link>
    <description>Recent content in Lock on Hextra</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Mon, 21 Nov 2022 22:01:56 +0800</lastBuildDate>
    
	  <atom:link href="https://mobilephone724.github.io/tags/lock/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Phantoms Predicate Lock</title>
      <link>https://mobilephone724.github.io/database/predicate_lock/</link>
      <pubDate>Mon, 21 Nov 2022 22:01:56 +0800</pubDate>
      
      <guid>https://mobilephone724.github.io/database/predicate_lock/</guid>
      <description>
        
        
        &lt;h1&gt;Intro&lt;/h1&gt;&lt;h2&gt;Phantoms&lt;span class=&#34;absolute -mt-20&#34; id=&#34;phantoms&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#phantoms&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The idea comes from which is an object, the table or its each tuple. The former
is unacceptable. But the latter, when tupples appear or disappear from a table,
select statements can conflict with the change, which is called the phantoms.&lt;/p&gt;
&lt;h2&gt;Predicate Lock&lt;span class=&#34;absolute -mt-20&#34; id=&#34;predicate-lock&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#predicate-lock&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Although predicate lock is too expensive, it&amp;rsquo;s a good way to think about things.&lt;/p&gt;
&lt;p&gt;predicate lock can be writen like&lt;/p&gt;
&lt;div class=&#34;code-block relative mt-6 first:mt-0 group/code&#34;&gt;&lt;pre&gt;&lt;code id=&#34;code-block-0&#34;&gt;&amp;lt;tid, [slock|xlock], predicate&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0&#34;&gt;
    &lt;button
      class=&#34;code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50&#34;
      title=&#34;Copy code&#34;
      data-clipboard-target=&#34;#code-block-0&#34;
    &gt;
      &lt;div class=&#34;group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4&#34;&gt;&lt;/div&gt;
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Two predicate locks are compatible iff&lt;/p&gt;
&lt;div class=&#34;code-block relative mt-6 first:mt-0 group/code&#34;&gt;&lt;pre&gt;&lt;code id=&#34;code-block-1&#34;&gt;tid1 = tid2 (a transaction can&amp;#39;t conflict with itself), or
both are slock (no changes makes no conflict ), or
predicate1 and predicate2 can&amp;#39;t be satisfied at the same time&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;opacity-0 transition group-hover/code:opacity-100 flex gap-1 absolute m-[11px] right-0 top-0&#34;&gt;
    &lt;button
      class=&#34;code-copy-btn group/copybtn transition-all active:opacity-50 bg-primary-700/5 border border-black/5 text-gray-600 hover:text-gray-900 rounded-md p-1.5 dark:bg-primary-300/10 dark:border-white/10 dark:text-gray-400 dark:hover:text-gray-50&#34;
      title=&#34;Copy code&#34;
      data-clipboard-target=&#34;#code-block-1&#34;
    &gt;
      &lt;div class=&#34;group-[.copied]/copybtn:hidden copy-icon pointer-events-none h-4 w-4&#34;&gt;&lt;/div&gt;
      &lt;div class=&#34;hidden group-[.copied]/copybtn:block success-icon pointer-events-none h-4 w-4&#34;&gt;&lt;/div&gt;
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;When applying the lock system, use two structure, a granted set and a waiting list.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Each time a tx requries a predicate lock, the system compares the lock with each
other in the granted set and waiting list. If the predicate lock is compatibal, add it
to granted set, otherwise to waiting list.&lt;/li&gt;
&lt;li&gt;Each time a tx ends, remove all its predicated lock from both the granted set and
the waiting list. And grant each predicate lock in the waiting list if it&amp;rsquo;s compatible now,
until reach the end of the list or encouter an incompatible predicate lock.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;The problem with predicate locks&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;

      </description>
    </item>
    
  </channel>
</rss>
