<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="从0证明RSA
RSA 算法（即一个非对称加密算法）除了应用非常广泛外，其特性也非常吸引人（起码非常吸引我）。我在网上找了很多关于RSA的证明，要么不够详细（例如缺失对前置定理的证明），要么需要引出较多复杂的数论概念。作者本身水平不高，试图绕过这些复杂的概念，从初等数学的开始，完备地证明RSA。
关于RSA的背景知识可能很多，可以慢慢阅读，我在此尝试从初等数学开始证明。这些背景知识的证明有一定的顺序，如果读者发现某个证明看不懂，可以向前翻阅。
参考的文章如下：（因为参考的文章太多，大概率不全）

费马小定理
中国剩余定理
阮一峰的博客——RSA算法原理（一）
阮一峰的博客——RSA算法原理（二）
初等数论笔记Part 1： 欧拉定理
算法学习笔记(9)：逆元

费马小定理
简介
如果 $p$ 是质数且 $\mathrm{gcd}(a,p)=1$ , 那么 $a^{p-1}\equiv 1\ (\mathrm{mod}\ p)$
在证明该定理前，先证明一个简单的引理
引理1
如果 $p$ 是质数，且 $\mathrm{gcd}(a,p)=1$ , 那么
$$
\lbrace ka \ \mathrm{mod}\ p | k = \lbrace 1,2,&hellip;,p -1 \rbrace \rbrace= \lbrace 1,2,3,&hellip;,p-1 \rbrace
$$
即二者存在一对一的关系。由于这两个集合的元素个数相同，所以只要证明左侧集合没有重复元素即可
证明：假设存在 $k_1$ 和 $k_2$ 满足 $1 \leq k_1 &lt; k_2 \leq p-1$ ，且 $k_1a\ \mathrm{mod}\ p = k_2a\ \mathrm{mod}\ p$ . 那么可知">  

  <title>
    
      ZERO TO RSA
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.51652302d3a998bf7887aed5c2cf89141bbebdf45a2c8f87b0717a3cf4f51c4e53c694c328fb1de78c3a625a1c01f80745bf1f2f42c040647a245cbbb6c2d1d7.css" integrity="sha512-UWUjAtOpmL94h67Vws&#43;JFBu&#43;vfRaLI&#43;HsHF6PPT1HE5TxpTDKPsd54w6YlocAfgHRb8fL0LAQGR6JFy7tsLR1w==" />
   <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 
</head>
<body a="auto">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">..</a>


<article>
    <p class="post-meta">
        <time datetime="0001-01-01 00:00:00 &#43;0000 UTC">
            0001-01-01
        </time>
    </p>

    <h1>ZERO TO RSA</h1>

    

    <h2 id="从0证明rsa">从0证明RSA</h2>
<p>RSA 算法（即一个非对称加密算法）除了应用非常广泛外，其特性也非常吸引人（起码非常吸引我）。我在网上找了很多关于RSA的证明，要么不够详细（例如缺失对前置定理的证明），要么需要引出较多复杂的数论概念。作者本身水平不高，试图绕过这些复杂的概念，从初等数学的开始，完备地证明RSA。</p>
<p>关于RSA的背景知识可能很多，可以慢慢阅读，我在此尝试从初等数学开始证明。这些背景知识的证明有一定的顺序，如果读者发现某个证明看不懂，可以向前翻阅。</p>
<p>参考的文章如下：（因为参考的文章太多，大概率不全）</p>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86">费马小定理</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86">中国剩余定理</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html">阮一峰的博客——RSA算法原理（一）</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html">阮一峰的博客——RSA算法原理（二）</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/35060143">初等数论笔记Part 1： 欧拉定理</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/100587745">算法学习笔记(9)：逆元</a></li>
</ul>
<h2 id="费马小定理">费马小定理</h2>
<h3 id="简介">简介</h3>
<p>如果 $p$ 是质数且 $\mathrm{gcd}(a,p)=1$ , 那么 $a^{p-1}\equiv 1\ (\mathrm{mod}\ p)$</p>
<p>在证明该定理前，先证明一个简单的引理</p>
<h3 id="引理1">引理1</h3>
<p>如果 $p$ 是质数，且 $\mathrm{gcd}(a,p)=1$ , 那么</p>
<p>$$
\lbrace ka \ \mathrm{mod}\ p | k = \lbrace 1,2,&hellip;,p -1 \rbrace \rbrace= \lbrace 1,2,3,&hellip;,p-1 \rbrace
$$</p>
<p>即二者存在一对一的关系。由于这两个集合的元素个数相同，所以只要证明左侧集合没有重复元素即可</p>
<p>证明：假设存在 $k_1$ 和 $k_2$ 满足 $1 \leq k_1 &lt; k_2 \leq p-1$ ，且 $k_1a\ \mathrm{mod}\ p = k_2a\ \mathrm{mod}\ p$ . 那么可知</p>
<p>$$
(k_1+p-k_2)a\ \mathrm{mod}\ p = pa\ \mathrm{mod}\ p=0
$$</p>
<p>即 $(k_1+p-k_2)a\ \mathrm{mod}\ p=0$ 。由于 $p$ 是质数，那么 $(k_1+p-k_2)a$ 一定是 $p$​​ 的倍数，这显然不可能。</p>
<h3 id="证明费马小定理">证明费马小定理</h3>
<p>$$
\begin{align}
(1a)(2a)(3a)&hellip;((p-1)a)\ \mathrm{mod}\ p &amp;= (a^{p-1}(p-1)!)\ \mathrm{mod}\ p \newline
(1a\ \mathrm{mod}\ p)(2a\ \mathrm{mod}\ p)&hellip;((p-1)a\ \mathrm{mod}\ p) &amp;=  (a^{p-1}(p-1)!)\ \mathrm{mod}\ p\newline
(p-1)! &amp;= (a^{p-1}(p-1)!)\ \mathrm{mod}\ p
\end{align}
$$</p>
<p>整理得 $a^{p-1}\equiv 1\ (\mathrm{mod}\ p)$​</p>
<h2 id="模逆元">模逆元</h2>
<h3 id="简介-1">简介</h3>
<p>定义： $a$ 对 $n$ 的<strong>模逆元</strong>是满足 $ab\equiv 1\ (\mathrm{mod}\ n)$ 的 $b$​</p>
<p><strong>模逆元的存在性</strong>：模逆元存在的充要条件是 $\mathrm{gcd}(a,n)=1$​</p>
<p>为证明该存在性定理，需要先证明引理2</p>
<h3 id="引理2">引理2</h3>
<p>若 $\mathrm{gcd}(a,n)=g$ ，则存在 $x,y\in Z$，满足 $ax+ny=g$</p>
<p>证明：</p>
<ul>
<li>设集合 $S=\lbrace ax+ny|x,y\in Z \rbrace $，显然，存在 $s\in S$ 并且 $s&gt;0$</li>
<li>设 $d$ 为 $S$ 中最小的，大于 $0$ 的元素</li>
<li>若 $a\ \mathrm{mod}\ p\neq 0$ ，则存在 $k,r$ 满足 $a=kd+r$ ，其中 $0 &lt; r &lt; k$ ，带入 $d=ax_0+ny_0$ ，得到 $r=a(1-kx_0)+n(-ky_0)$ 。 显然 $r\in S$ ，又 $0 &lt; r &lt; k$ ，这与 $d$ 为 $S$ 中最小的大于 $0$ 的假设不符。</li>
<li>故 $a\ \mathrm{mod}\ d=0$ ，同理 $n\ \mathrm{mod}\ d=0$</li>
<li>所以 $d$ 为 $a$ 和 $n$ 共同的因数。设 $g=ld$ ， $l\geq0$ 且 $l\in Z$ ，那么有 $g=ld=a(lx_0)+n(ly_0)$ 。</li>
</ul>
<h3 id="证明模逆元">证明模逆元</h3>
<p>现在证明模逆元</p>
<p>充分性</p>
<ul>
<li>已知 $\mathrm{gcd}(a,n)=1$ ，则有 $1=ax_0+ny_0$</li>
<li>$(ax_0+ny_0)\ \mathrm{mod}\ n = ax_0 \ \mathrm{mod}\ n $​</li>
<li>$(ax_0+ny_0)\ \mathrm{mod}\ n= 1 \ \mathrm{mod}\ n=1$</li>
<li>故 $ax_0 \ \mathrm{mod}\ n=1$ 即 $ax_0\ \equiv 1\ (\mathrm{mod}\ n)$ ， $b=x_0$</li>
</ul>
<p>必要性：</p>
<ul>
<li>已经存在 $b$ 满足 $ab\ \equiv 1\ (\mathrm{mod}\ n)$​</li>
<li>则存在 $y,k$ 满足 $(ab+ny)\ \mathrm{mod}\ n=1$</li>
<li>则存在 $k$ 满足 $ab+ny-1=kn$</li>
<li>即 $ab + n(y-k)=1$</li>
<li>根据<strong>引理2</strong>，有 $\mathrm{gcd}(a,n)\leq 1$ ，显然只有 $\mathrm{gcd}(a,n)=1$</li>
</ul>
<h2 id="中国剩余定理">中国剩余定理</h2>
<p>方程组</p>
<p>$$
\begin{equation}
\begin{cases}
x\ \equiv a_1\ (\mathrm{mod}\ m_1)\newline
x\ \equiv a_2\ (\mathrm{mod}\ m_2)\newline
&hellip;\newline
x\ \equiv a_n\ (\mathrm{mod}\ m_n)\newline
\end{cases}
\end{equation}
$$</p>
<p>其中对于任意 $i\neq j$ 有 $\mathrm{gcd}(m_i,m_j)=1$ ，对于任意 $a_1,a_2,&hellip;,a_n$ 有解。</p>
<p>证明：如下</p>
<p>存在性</p>
<ul>
<li>令 $M=m_1m_2,&hellip;m_n=\prod\limits_{i=1}^{n}m_i$， $M_i=M/m_i$</li>
<li>显然有 $\mathrm{gcd}(M_i,m_i)=1$ ，故存在 $t_i$ 满足 $M_it_i\ \equiv 1\ (\mathrm{mod}\ m_i)$</li>
<li>故对于 $x\ \equiv a_1\ (\mathrm{mod}\ m_1)$ ，有 $a_iM_it_i\ \equiv a_i\ (\mathrm{mod}\ m_i)$</li>
<li>故可得 $x$ 的一个解 $x=\sum\limits_{i=1}^{n}a_iM_it_i$</li>
</ul>
<p>完备性</p>
<ul>
<li>若 $x_1,x_2$ 都是方程组的解，那么对于任意 $i\in \lbrace 1,2,&hellip;,n \rbrace$ ，有 $(x_1-x_2)\ \mathrm{mod}\ m_i=0$</li>
<li>故 $x_1-x_2=kM$</li>
<li>所以通解为 ${kM+}\sum\limits_{i=1}^{n}a_iM_it_i$</li>
</ul>
<h2 id="欧拉公式">欧拉公式</h2>
<h3 id="简介-2">简介</h3>
<ul>
<li>函数 $\phi(n)$ 为 $\lbrace 1,2,&hellip;,n \rbrace$ 中和 $n$ 互质的数的数量</li>
<li>例如 $\phi(8)=4$ ，因为 $\mathrm{gcd}(\lbrace 1,3,5,7 \rbrace,4)=1$</li>
</ul>
<h3 id="性质">性质</h3>
<p><strong>（性质1）</strong></p>
<p>对于质数 $n$ ，有 $\phi(n)=n-1$</p>
<p><strong>（性质2）</strong></p>
<p>若存在质数 $p$ 满足 $n=p^k$ ，则 $\phi(n)=p^k-p^k/p=n(1-1/p)$ 。思路为 $\lbrace 1,2,&hellip;,n \rbrace$ 中除去 $p$ 的倍数</p>
<p><strong>（性质3）</strong></p>
<p>若 $\mathrm{gcd}(m,n)=1$ ，则 $\phi(mn)=\phi(m)\phi(n)$ ​。证明如下：</p>
<ul>
<li>对于任意 $0 &lt; N &lt; mn$ ，有 $N=k_1m+p=k_2n+q$ 。假设 $N$ 满足 $\mathrm{gcd}(N,mn)=1$</li>
<li>显然， $\mathrm{gcd}(N,m)=1$ ，故 $\mathrm{gcd}(k_1m+p,m)=1$ ，显然 $\mathrm{gcd}(p,m)=1$ 。同理 $\mathrm{gcd}(q,n)$ 。</li>
<li>对于方程组</li>
</ul>
<p>$$
\begin{equation}
\begin{cases}
N\ \equiv p\ (\mathrm{mod}\ m)\newline
N\ \equiv q\ (\mathrm{mod}\ n)
\end{cases}
\end{equation}
$$</p>
<p>根据中国剩余定理，有解 $N=kmn+t_ppn+t_qqm$ 。</p>
<p>每有一组 $(p,q)$ ，该方程组就有一个解。注意 $\mathrm{gcd}(p,m)=1$ ,且 $\mathrm{gcd}(q,n)$ 。</p>
<p><strong>（性质4）</strong></p>
<p>对于 $n=\prod\limits_{i=1}^rp_i^{k_i}$ ，有 $\phi(n)=\phi(\prod\limits_{i=1}^rp_i^{k_i})=\prod\limits_{i=1}^r\phi(p_i^{k_i})=\prod\limits_{i=1}^r(n(1-1/p_i))=n^r\prod\limits_{i=1}^r(1-1/p_i)$</p>
<h2 id="欧拉定理">欧拉定理</h2>
<h3 id="简介-3">简介</h3>
<p>若 $n,a$ 为正整数，且 $\mathrm{gcd}(n,a)=1$ 则 $a^{\phi(n)}\ \equiv 1\ (\mathrm{mod}\ n)$​</p>
<h3 id="欧拉定理的证明">欧拉定理的证明</h3>
<p>设 $\Phi(n)=\lbrace c_1,c_2,&hellip;,c_{\phi(n)} \rbrace$ 为小于 $n$ 且与 $n$ 互质的数的集合，即 $\mathrm{gcd}(c_i,n)=1$。</p>
<p>若 $\mathrm{gcd}(a,n)=1$ ，考虑集合 $\Phi_a(n)=\lbrace (ac_1)\ \mathrm{mod}\ n,(ac_2)\ \mathrm{mod}\ n,&hellip;,(ac_{\phi(n)})\ \mathrm{mod}\ n \rbrace$ 。我们证明 $\Phi(n)=\Phi_a(n)$</p>
<p>先证明 $\Phi_a(n)$ 中没有重复的元素，若 $ac_i\ \equiv ac_j\ (\mathrm{mod}\ n)$ ,则 $c_i\ \equiv c_j\ (\mathrm{mod}\ n)$ ，这显然错误。</p>
<p>再证明 $\mathrm{gcd}(ac_i\ \mathrm{mod}\ n, n)=1$ 。设 $ac_i=k_in+r_i$ ，若 $\mathrm{gcd}(r_i,n)=g$ ，则 $ac_i=g(k_i(n/g)+(r_i/g))$ 。等式右侧是 $g$ 的倍数，而左侧显然不是（ $a$ 和 $c$ 都与 $n$ 互质）</p>
<p>所以：</p>
<p>$$
\prod\limits_{i=1}^{\phi(n)}c_i \ \equiv \prod\limits_{i=1}^{\phi(n)}c_ia(\ \mathrm{mod}\ n)
$$</p>
<p>即</p>
<p>$$
\prod\limits_{i=1}^{\phi(n)}c_i \ \equiv a^{\phi(n)}\prod\limits_{i=1}^{\phi(n)}c_i(\ \mathrm{mod}\ n)
$$</p>
<p>显然 $\mathrm{gcd}(\prod\limits_{i=1}^{\phi(n)}c_i,n)=1$</p>
<p>故</p>
<p>$$
a^{\phi(n)}\ \equiv 1\ (\mathrm{mod}\ n)
$$</p>
<h2 id="rsa算法">RSA算法</h2>
<h3 id="算法流程">算法流程</h3>
<ol>
<li>生成秘钥
<ol>
<li>选择连个大质数 $p$ 和 $q$ ，计算 $n=p * q$</li>
<li>计算 $\phi(n)=(p-1)(q-1)$</li>
<li>选择正整数 $e$ 满足 $1 &lt; e &lt; \phi(n)$ ，且 $\mathrm{gcd}(e,\phi(n))=1$</li>
<li>计算 $e$ 对 $\phi(n)$ 的模逆元 $d$ ，即 $ed\ \equiv 1\ (\mathrm{mod}\ \phi(n))$</li>
<li>得到公钥对 $(n,e)$ ，私钥对 $(n, d)$</li>
</ol>
</li>
<li>加密
<ol>
<li>加密的数为 $m$ ，满足 $0\leq m &lt; n$</li>
<li>计算 $c=m^e\ \mathrm{mod}\ n$ ，则 $c$ 就是密文</li>
</ol>
</li>
<li>解密
<ol>
<li>$m=c^d\ \mathrm{mod}\ n$</li>
</ol>
</li>
</ol>
<h3 id="算法证明">算法证明</h3>
<p>显然，核心点在于证明 $m=c^d\ \mathrm{mod}\ n$​ 。</p>
<p>简答化简可得， $c^d\ \mathrm{mod}\ n=(m^e\ \mathrm{mod}\ n)^d\ \mathrm{mod}\ n=m^{ed}\ \mathrm{mod}\ n$​</p>
<p>根据 $ed\ \equiv 1\ (\mathrm{mod}\ \phi(n))$ ，可知存在 $k$ 使得 $ed=k\phi(n)+1$ ，带入 $m^{ed}\ \mathrm{mod}\ n$ 得，</p>
<p>$$
\begin{align}
m^{ed}\ \mathrm{mod}\ n&amp;= m^{k\phi(n)+1}\ \mathrm{mod}\ n \newline
&amp;= ((m^{\phi(n)} \mathrm{mod}\ n)^k*(m\ \mathrm{mod}\ n))\ \mathrm{mod}\ n \newline
&amp;= (m(m^{\phi(n)} \mathrm{mod}\ n)^k) \ \mathrm{mod}\ n
\end{align}
$$</p>
<h4 id="通常情况">通常情况</h4>
<p>当 $\mathrm{gcd}(m,n)=1$ 时（即 $m\neq hp$ 且 $m\neq hq$ 时），根据欧拉定理 $m^{\phi(n)}\ \equiv 1\ (\mathrm{mod}\ n)$ ，可知 $m^{\phi(n)} \mathrm{mod}\ n=1$​</p>
<p>则 $m^{ed}\ \mathrm{mod}\ n = m\ \mathrm{mod}\ n=m$</p>
<h4 id="特殊情况">特殊情况</h4>
<p>当 $m=hp$ 时，（ $m=hq$ 同理）有 $m^{\phi(n)} \mathrm{mod}\ n = (hp)^{(p-1)(q-1)}\mathrm{mod}\ pq$</p>
<p>而因为 $q$ 是质数，根据费马小定理，有 $((hp)^{k(p-1)})^{q-1}\ \equiv 1\ (\mathrm{mod}\ q)$ 。故</p>
<p>$$
\begin{align}
((hp)^{k(p-1)})^{q-1}hp\ &amp;\equiv hp\ (\mathrm{mod}\ q) \newline
(hp)^{k(p-1)(q-1)+1}\ &amp;\equiv hp\ (\mathrm{mod}\ q) \newline
(hp)^{(cd)}\ &amp;\equiv hp\ (\mathrm{mod}\ q)
\end{align}
$$</p>
<p>故存在 $t$ 满足</p>
<p>$$
(hp)^{ed}=tq+hp
$$</p>
<p>注意，等式左侧是 $p$ 的倍数，而 $p$ 是质数，故 $t$ 必定是 $p$ 的倍数，设 $t=t&rsquo;p$ ，则</p>
<p>$$
\begin{align}
(hp)^{ed}&amp;=t&rsquo;pq+hp=t&rsquo;n+hp \newline
m^{ed}\ &amp;\equiv m\ (\mathrm{mod}\ n) \newline
m^{ed-1} \ &amp;\equiv 1\ (\mathrm{mod}\ n) \newline
m^{k\phi(n)} \ &amp;\equiv 1\ (\mathrm{mod}\ n)
\end{align}
$$</p>
<p>同理 $m^{ed}\ \mathrm{mod}\ n = (m(m^{\phi(n)} \mathrm{mod}\ n)^k) \ \mathrm{mod}\ n = m\ \mathrm{mod}\ n=m$</p>

</article>

                
    
    
        <hr>
<p>written by mobilephone724</p>
    


            </div>
        </main>
    </body>
</html>
